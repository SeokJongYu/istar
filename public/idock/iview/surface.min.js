var ProteinSurface=function(){var n,o,r,t,s,e,a,f,v,u,y,h,d,x,z,l,w,p=128,c=1.4,m=1,b=[1.9,1.88,1.63,1.48,1.78,1.2,1.87,1.96,1.63,.74,1.8,1.48,1.2],M=new Array(13),A=new Array(13),g=2,q=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1],[1,1,0],[1,-1,0],[-1,1,0],[-1,-1,0],[1,0,1],[1,0,-1],[-1,0,1],[-1,0,-1],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[1,1,1],[1,1,-1],[1,-1,1],[-1,1,1],[1,-1,-1],[-1,-1,1],[-1,1,-1],[-1,-1,-1]],C=function(i,n,o){this.x=i,this.y=n,this.z=o},P=function(i,n,o){this.a=i,this.b=n,this.c=o};this.initparm=function(i,f,v){var l=2.5;u=i.x,d=f.x,y=i.y,x=f.y,h=i.z,z=f.z,v?(u-=l,y-=l,h-=l,d+=l,x+=l,z+=l):(u-=c+l,y-=c+l,h-=c+l,d+=c+l,x+=c+l,z+=c+l),n=-u,o=-y,r=-h,m=d-u,x-y>m&&(m=x-y),z-h>m&&(m=z-h),m=(p-1)/m,p=Math.floor(p*g/m),m=g;var w=180;p>w&&(sfthresh=w/p,p=Math.floor(w),m*=sfthresh),e=Math.ceil(m*(d-u))+1,s=Math.ceil(m*(x-y))+1,t=Math.ceil(m*(z-h))+1,e>p&&(e=p),s>p&&(s=p),t>p&&(t=p),this.boundingatom(v),cutRadis=c*m,a=new Array(e*s*t)},this.boundingatom=function(i){for(var n,o,r,t=new Array(13),s=0;13>s;++s)for(t[s]=i?(b[s]+c)*m+.5:b[s]*m+.5,r=t[s]*t[s],A[s]=Math.floor(t[s])+1,M[s]=new Array(A[s]*A[s]),indx=0,j=0;j<A[s];++j)for(k=0;k<A[s];++k)n=j*j+k*k,n>r?M[s][indx]=-1:(o=Math.sqrt(r-n),M[s][indx]=Math.floor(o)),indx++},this.fillvoxels=function(i){for(var n=0,o=a.length;o>n;++n)a[n]={inout:!1,isdone:!1,isbound:!1,distance:-1,atomid:-1};for(n in i)this.fillAtom(i[n],i);for(n=0,o=a.length;o>n;++n)a[n].inout&&(a[n].isdone=!0);this.vp=a;for(var n=0,o=a.length;o>n;++n)a[n].inout&&(a[n].isdone=!0)},this.fillAtom=function(f,v){var u,y,h,d,x,z;u=Math.floor(.5+m*(f.coord.x+n)),y=Math.floor(.5+m*(f.coord.y+o)),h=Math.floor(.5+m*(f.coord.z+r));var l=this.getAtomType(f),w=0;for(i=0;i<A[l];++i)for(j=0;j<A[l];++j){if(-1!=M[l][w])for(ii=-1;2>ii;++ii)for(jj=-1;2>jj;++jj)for(kk=-1;2>kk;++kk)if(0!=ii&&0!=jj&&0!=kk)for(mi=ii*i,mk=kk*j,k=0;k<=M[l][w];++k)if(mj=k*jj,si=u+mi,sj=y+mj,sk=h+mk,!(0>si||0>sj||0>sk||si>=e||sj>=s||sk>=t)){var p=a[si*s*t+sj*t+sk];if(0==p.inout)p.inout=!0,p.atomid=f.serial;else if(p.inout){var c=v[p.atomid];d=Math.floor(.5+m*(c.coord.x+n)),x=Math.floor(.5+m*(c.coord.y+o)),z=Math.floor(.5+m*(c.coord.z+r)),d*d+x*x+z*z>mi*mi+mj*mj+mk*mk&&(p.atomid=f.serial)}}w++}},this.fillvoxelswaals=function(i){for(var n=0,o=a.length;o>n;++n)a[n].isdone=!1;for(n in i)this.fillAtomWaals(i[n],i)},this.fillAtomWaals=function(e,f){var v,u,y,h,d,x,z=0;v=Math.floor(.5+m*(e.coord.x+n)),u=Math.floor(.5+m*(e.coord.y+o)),y=Math.floor(.5+m*(e.coord.z+r));var l=this.getAtomType(e);for(i=0;i<A[l];++i)for(j=0;j<A[l];++j){if(-1!=M[l][z])for(ii=-1;2>ii;++ii)for(jj=-1;2>jj;++jj)for(kk=-1;2>kk;++kk)if(0!=ii&&0!=jj&&0!=kk)for(mi=ii*i,mk=kk*j,k=0;k<=M[l][z];++k)if(mj=k*jj,si=v+mi,sj=u+mj,sk=y+mk,!(0>si||0>sj||0>sk)){var w=a[si*s*t+sj*t+sk];if(0==w.isdone)w.isdone=!0,w.atomid=e.serial;else if(w.isdone){var p=f[w.atomid];h=Math.floor(.5+m*(p.coord.x+n)),d=Math.floor(.5+m*(p.coord.y+o)),x=Math.floor(.5+m*(p.coord.z+r)),h*h+d*d+x*x>mi*mi+mj*mj+mk*mk&&(w.atomid=e.serial)}}z++}},this.getAtomType=function(i){var n=10;return"CA"==i.name?n=0:"C"==i.name?n=1:"C"==i.elem?n=7:"0"==i.name?n=3:"O"==i.elem?n=11:"N"==i.name?n=2:"N"==i.elem?n=8:"S"==i.elem?n=4:"P"==i.elem?n=6:"FE"==i.name?n=9:"H"==i.name?n=5:"H"==i.elem&&(n=12),n},this.buildboundary=function(){for(a=this.vp,i=0;e>i;++i)for(j=0;t>j;++j)for(k=0;s>k;++k){var n=a[i*s*t+k*t+j];if(n.inout)for(var o=!1,r=0;!o&&26>r;){var f=i+q[r][0],v=j+q[r][2],u=k+q[r][1];f>-1&&e>f&&u>-1&&s>u&&v>-1&&t>v&&!a[f*s*t+u*t+v].inout?(n.isbound=!0,o=!0):r++}}},this.fastdistancemap=function(){var i,n;totalsurfacevox=0,totalinnervox=0;for(var o=new Array(e),r=0;e>r;++r){for(var f=new Array(s),v=0;s>v;++v){for(var u=new Array(t),y=0;t>y;++y)u[y]={ix:0,iy:0,iz:0};f[v]=u}o[r]=f}for(r=0;e>r;++r)for(v=0;s>v;++v)for(y=0;t>y;++y){var h=a[r*s*t+v*t+y];h.isdone=!1,h.inout&&(h.isbound?(totalsurfacevox++,o[r][v][y].ix=r,o[r][v][y].iy=v,o[r][v][y].iz=y,h.distance=0,h.isdone=!0):totalinnervox++)}inarray=new Array,outarray=new Array;var i=0,n=0;for(r=0;e>r;++r)for(v=0;s>v;++v)for(y=0;t>y;++y){var h=a[r*s*t+v*t+y];h.isbound&&(inarray.push({ix:r,iy:v,iz:y}),i++,h.isbound=!1)}do for(n=this.fastoneshell(i,o),i=0,inarray=[],r=0;n>r;++r){var d=a[s*t*outarray[r].ix+t*outarray[r].iy+outarray[r].iz];d.isbound=!1,d.distance<=1.02*cutRadis&&(inarray.push({ix:outarray[r].ix,iy:outarray[r].iy,iz:outarray[r].iz}),i++)}while(0!=i);var x=m-.5;for(0>x&&(x=0),r=0;e>r;++r)for(v=0;s>v;++v)for(y=0;t>y;++y){var h=a[r*s*t+v*t+y];h.isbound=!1,h.inout&&(!h.isdone||h.isdone&&h.distance>=cutRadis-.5/(.1+x))&&(h.isbound=!0)}inarray=[],outarray=[]},this.fastoneshell=function(i,n){var o,r,f,v,u,y,h,d=0;if(0==i)return 0;outarray=[],tnv={ix:-1,iy:-1,iz:-1};for(var x=0;i>x;++x){o=inarray[x].ix,r=inarray[x].iy,f=inarray[x].iz;for(var z=0;6>z;++z){tnv.ix=o+q[z][0],tnv.iy=r+q[z][1],tnv.iz=f+q[z][2];var l=a[tnv.ix*s*t+t*tnv.iy+tnv.iz];if(tnv.ix<e&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<t&&tnv.iz>-1&&l.inout&&!l.isdone){n[tnv.ix][tnv.iy][f+q[z][2]].ix=n[o][r][f].ix,n[tnv.ix][tnv.iy][f+q[z][2]].iy=n[o][r][f].iy,n[tnv.ix][tnv.iy][f+q[z][2]].iz=n[o][r][f].iz,v=tnv.ix-n[o][r][f].ix,u=tnv.iy-n[o][r][f].iy,y=tnv.iz-n[o][r][f].iz;var h=v*v+u*u+y*y;l.distance=Math.sqrt(h),l.isdone=!0,l.isbound=!0,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}),d++}else tnv.ix<e&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<t&&tnv.iz>-1&&l.inout&&l.isdone&&(v=tnv.ix-n[o][r][f].ix,u=tnv.iy-n[o][r][f].iy,y=tnv.iz-n[o][r][f].iz,h=v*v+u*u+y*y,h=Math.sqrt(h),h<l.distance&&(n[tnv.ix][tnv.iy][tnv.iz].ix=n[o][r][f].ix,n[tnv.ix][tnv.iy][tnv.iz].iy=n[o][r][f].iy,n[tnv.ix][tnv.iy][tnv.iz].iz=n[o][r][f].iz,l.distance=h,l.isbound||(l.isbound=!0,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}),d++)))}}for(x=0;i>x;++x)for(o=inarray[x].ix,r=inarray[x].iy,f=inarray[x].iz,z=6;18>z;++z){tnv.ix=o+q[z][0],tnv.iy=r+q[z][1],tnv.iz=f+q[z][2];var l=a[tnv.ix*s*t+t*tnv.iy+tnv.iz];tnv.ix<e&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<t&&tnv.iz>-1&&l.inout&&!l.isdone?(n[tnv.ix][tnv.iy][f+q[z][2]].ix=n[o][r][f].ix,n[tnv.ix][tnv.iy][f+q[z][2]].iy=n[o][r][f].iy,n[tnv.ix][tnv.iy][f+q[z][2]].iz=n[o][r][f].iz,v=tnv.ix-n[o][r][f].ix,u=tnv.iy-n[o][r][f].iy,y=tnv.iz-n[o][r][f].iz,h=v*v+u*u+y*y,l.distance=Math.sqrt(h),l.isdone=!0,l.isbound=!0,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}),d++):tnv.ix<e&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<t&&tnv.iz>-1&&l.inout&&l.isdone&&(v=tnv.ix-n[o][r][f].ix,u=tnv.iy-n[o][r][f].iy,y=tnv.iz-n[o][r][f].iz,h=Math.sqrt(v*v+u*u+y*y),h<l.distance&&(n[tnv.ix][tnv.iy][tnv.iz].ix=n[o][r][f].ix,n[tnv.ix][tnv.iy][tnv.iz].iy=n[o][r][f].iy,n[tnv.ix][tnv.iy][tnv.iz].iz=n[o][r][f].iz,l.distance=h,l.isbound||(l.isbound=!0,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}),d++)))}for(x=0;i>x;++x)for(o=inarray[x].ix,r=inarray[x].iy,f=inarray[x].iz,z=18;26>z;++z){tnv.ix=o+q[z][0],tnv.iy=r+q[z][1],tnv.iz=f+q[z][2];var l=a[tnv.ix*s*t+t*tnv.iy+tnv.iz];tnv.ix<e&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<t&&tnv.iz>-1&&l.inout&&!l.isdone?(n[tnv.ix][tnv.iy][f+q[z][2]].ix=n[o][r][f].ix,n[tnv.ix][tnv.iy][f+q[z][2]].iy=n[o][r][f].iy,n[tnv.ix][tnv.iy][f+q[z][2]].iz=n[o][r][f].iz,v=tnv.ix-n[o][r][f].ix,u=tnv.iy-n[o][r][f].iy,y=tnv.iz-n[o][r][f].iz,h=v*v+u*u+y*y,l.distance=Math.sqrt(h),l.isdone=!0,l.isbound=!0,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}),d++):tnv.ix<e&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<t&&tnv.iz>-1&&l.inout&&l.isdone&&(v=tnv.ix-n[o][r][f].ix,u=tnv.iy-n[o][r][f].iy,y=tnv.iz-n[o][r][f].iz,h=Math.sqrt(v*v+u*u+y*y),h<l.distance&&(n[tnv.ix][tnv.iy][tnv.iz].ix=n[o][r][f].ix,n[tnv.ix][tnv.iy][tnv.iz].iy=n[o][r][f].iy,n[tnv.ix][tnv.iy][tnv.iz].iz=n[o][r][f].iz,l.distance=h,l.isbound||(l.isbound=!0,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz}),d++)))}return d},this.marchingcube=function(i){for(var n=0,o=a.length;o>n;++n)3==i?a[n].isbound=!1:4==i?(a[n].isdone=!1,a[n].isbound&&(a[n].isdone=!0),a[n].isbound=!1):2==i?a[n].isbound&&a[n].isdone?a[n].isbound=!1:a[n].isbound&&!a[n].isdone&&(a[n].isdone=!0):3==i&&(a[n].isbound=!1);for(var r=new Array(e),n=0;e>n;++n){for(var u=new Array(s),y=0;s>y;++y){for(var h=new Array(t),d=0;t>d;++d)h[d]=-1;u[y]=h}r[n]=u}f=0,v=0,w=new Array,l=new Array;for(var x,z,p,c,m=new Array(6),n=0;6>n;++n)m[n]=new Array(3);for(n=0;1>n;++n)for(y=0;s-1>y;++y)for(d=0;t-1>d;++d){var k=a[s*t*n+t*y+d].isdone,b=a[s*t*n+t*y+d+1].isdone,j=a[s*t*n+t*(y+1)+d].isdone,M=a[s*t*n+t*(y+1)+d+1].isdone,A=a[s*t*(n+1)+t*y+d].isdone,g=a[s*t*(n+1)+t*y+d+1].isdone,q=a[s*t*(n+1)+t*(y+1)+d].isdone,R=a[s*t*(n+1)+t*(y+1)+d+1].isdone;if(k&&j&&M&&b){for(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[1][0]][m[1][1]][m[1][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[3][0]][m[3][1]][m[3][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}else if(k&&j&&M||j&&M&&b||M&&b&&k||b&&k&&j){for(k&&j&&M?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1):j&&M&&b?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):M&&b&&k?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d):b&&k&&j&&(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[1][0]][m[1][1]][m[1][2]])),v++}}for(n=0;e-1>n;++n)for(y=0;1>y;++y)for(d=0;t-1>d;++d){var k=a[s*t*n+t*y+d].isdone,b=a[s*t*n+t*y+d+1].isdone,A=a[s*t*(n+1)+t*y+d].isdone,g=a[s*t*(n+1)+t*y+d+1].isdone;if(k&&A&&g&&b){for(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else if(k&&A&&g||A&&g&&b||g&&b&&k||b&&k&&A){for(k&&A&&g?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):A&&g&&b?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):g&&b&&k?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d):b&&k&&A&&(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}}for(n=0;e-1>n;++n)for(y=0;s-1>y;++y)for(d=0;1>d;++d){var k=a[s*t*n+t*y+d].isdone,j=a[s*t*n+t*(y+1)+d].isdone,A=a[s*t*(n+1)+t*y+d].isdone,q=a[s*t*(n+1)+t*(y+1)+d].isdone;if(k&&A&&q&&j){for(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d,z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[1][0]][m[1][1]][m[1][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[3][0]][m[3][1]][m[3][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}else if(k&&A&&q||A&&q&&j||q&&j&&k||j&&k&&A){for(k&&A&&q?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):A&&q&&j?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):q&&j&&k?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):j&&k&&A&&(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[1][0]][m[1][1]][m[1][2]])),v++}}for(n=e-1;e>n;++n)for(y=0;s-1>y;++y)for(d=0;t-1>d;++d){var k=a[s*t*n+t*y+d].isdone,b=a[s*t*n+t*y+d+1].isdone,j=a[s*t*n+t*(y+1)+d].isdone,M=a[s*t*n+t*(y+1)+d+1].isdone;if(k&&j&&M&&b){for(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else if(k&&j&&M||j&&M&&b||M&&b&&k||b&&k&&j){for(k&&j&&M?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1):j&&M&&b?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):M&&b&&k?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d):b&&k&&j&&(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}}for(n=0;e-1>n;++n)for(y=s-1;s>y;++y)for(d=0;t-1>d;++d){var k=a[s*t*n+t*y+d].isdone,b=a[s*t*n+t*y+d+1].isdone,A=a[s*t*(n+1)+t*y+d].isdone,g=a[s*t*(n+1)+t*y+d+1].isdone;if(k&&A&&g&&b){for(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[1][0]][m[1][1]][m[1][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[3][0]][m[3][1]][m[3][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}else if(k&&A&&g||A&&g&&b||g&&b&&k||b&&k&&A){for(k&&A&&g?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):A&&g&&b?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):g&&b&&k?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d):b&&k&&A&&(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[1][0]][m[1][1]][m[1][2]])),v++}}for(n=0;e-1>n;++n)for(y=0;s-1>y;++y)for(d=t-1;t>d;++d){var k=a[s*t*n+t*y+d].isdone,j=a[s*t*n+t*(y+1)+d].isdone,A=a[s*t*(n+1)+t*y+d].isdone,q=a[s*t*(n+1)+t*(y+1)+d].isdone;if(k&&A&&q&&j){for(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d,z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else if(k&&A&&q||A&&q&&j||q&&j&&k||j&&k&&A){for(k&&A&&q?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):A&&q&&j?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):q&&j&&k?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):j&&k&&A&&(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}}for(n=0;e-1>n;++n)for(y=0;s-1>y;++y)for(d=0;t-1>d;++d){var k=a[s*t*n+t*y+d].isdone,b=a[s*t*n+t*y+d+1].isdone,j=a[s*t*n+t*(y+1)+d].isdone,M=a[s*t*n+t*(y+1)+d+1].isdone,A=a[s*t*(n+1)+t*y+d].isdone,g=a[s*t*(n+1)+t*y+d+1].isdone,q=a[s*t*(n+1)+t*(y+1)+d].isdone,R=a[s*t*(n+1)+t*(y+1)+d+1].isdone,x=0;for(z=0;2>z;++z)for(p=0;2>p;++p)for(c=0;2>c;++c)a[s*t*(n+z)+t*(y+p)+d+c].isdone&&x++;if(3==x){if(k&&A&&q||k&&j&&q||j&&A&&q||k&&j&&A||b&&g&&R||b&&M&&R||M&&g&&R||b&&M&&g||k&&A&&g||A&&g&&b||k&&g&&b||k&&A&&b||q&&A&&R||q&&g&&R||A&&g&&R||q&&A&&g||q&&j&&M||j&&M&&R||q&&M&&R||q&&j&&R||k&&j&&b||k&&b&&M||b&&j&&M||k&&j&&M){for(k&&A&&q?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):k&&j&&q?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):j&&A&&q?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):k&&j&&A?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):b&&g&&R?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):b&&M&&R?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1):M&&g&&R?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):b&&M&&g?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1):k&&A&&g?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):A&&g&&b?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):k&&g&&b?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):k&&A&&b?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):q&&A&&R?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):q&&g&&R?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):A&&g&&R?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1):q&&A&&g?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):q&&j&&M?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):j&&M&&R?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):q&&M&&R?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1):q&&j&&R?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1):k&&j&&b?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):k&&b&&M?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d):b&&j&&M?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):k&&j&&M&&(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}}else if(4==x){if(k&&A&&q&&j||b&&g&&R&&M||k&&A&&g&&b||q&&A&&g&&R||q&&j&&M&&R||k&&j&&b&&M){for(k&&A&&q&&j?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d):b&&g&&R&&M?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1):k&&A&&g&&b?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1):q&&A&&g&&R?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1):q&&j&&M&&R?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):k&&j&&b&&M&&(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1),z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else if(k&&A&&q&&M||k&&j&&q&&g||j&&A&&q&&b||k&&j&&A&&R||b&&g&&R&&j||b&&M&&R&&A||M&&g&&R&&k||b&&M&&g&&q||k&&A&&g&&M||A&&g&&b&&j||k&&g&&b&&q||k&&A&&b&&R||q&&A&&R&&b||q&&g&&R&&k||A&&g&&R&&j||q&&A&&g&&M||q&&j&&M&&g||j&&M&&R&&A||q&&M&&R&&k||q&&j&&R&&b||k&&j&&b&&R||k&&b&&M&&q||b&&j&&M&&A||k&&j&&M&&g){for(k&&A&&q&&M?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):k&&j&&q&&g?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):j&&A&&q&&b?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):k&&j&&A&&R?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):b&&g&&R&&j?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):b&&M&&R&&A?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1):M&&g&&R&&k?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):b&&M&&g&&q?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1):k&&A&&g&&M?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):A&&g&&b&&j?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):k&&g&&b&&q?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):k&&A&&b&&R?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):q&&A&&R&&b?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):q&&g&&R&&k?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):A&&g&&R&&j?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1):q&&A&&g&&M?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):q&&j&&M&&g?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):j&&M&&R&&A?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):q&&M&&R&&k?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1):q&&j&&R&&b?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1):k&&j&&b&&R?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):k&&b&&M&&q?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d):b&&j&&M&&A?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1):k&&j&&M&&g&&(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}else if(k&&M&&q&&j||k&&A&&q&&g||k&&b&&A&&j||j&&A&&q&&R||b&&M&&R&&j||b&&A&&R&&g||k&&b&&g&&M||M&&g&&q&&R){for(j&&M&&k&&q?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):A&&g&&q&&k?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):k&&b&&A&&j?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):q&&R&&j&&A?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):j&&M&&R&&b?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1):A&&g&&R&&b?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1):k&&b&&g&&M?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1):M&&g&&q&&R&&(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}else if(k&&A&&q&&b||j&&A&&q&&g||j&&k&&q&&R||j&&k&&A&&M||M&&b&&g&&A||R&&b&&g&&q||R&&M&&g&&j||R&&M&&b&&k||q&&M&&b&&j||g&&k&&b&&j||g&&k&&R&&A||M&&q&&R&&A){for(k&&A&&q&&b?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):j&&A&&q&&g?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):j&&k&&q&&R?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):j&&k&&A&&M?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):M&&b&&g&&A?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):R&&b&&g&&q?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):R&&M&&g&&j?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):R&&M&&b&&k?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):q&&M&&b&&j?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):g&&k&&b&&j?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):g&&k&&R&&A?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):M&&q&&R&&A&&(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1),z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else if(k&&A&&j&&g||k&&A&&q&&R||j&&A&&q&&M||j&&k&&q&&b||R&&b&&g&&k||R&&M&&g&&A||R&&M&&b&&q||g&&M&&b&&j||R&&M&&k&&j||A&&k&&b&&M||g&&b&&q&&A||j&&q&&R&&g){for(k&&A&&j&&g?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):k&&A&&q&&R?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):j&&A&&q&&M?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):j&&k&&q&&b?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):R&&b&&g&&k?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):R&&M&&g&&A?(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):R&&M&&b&&q?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):g&&M&&b&&j?(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):R&&M&&k&&j?(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d):A&&k&&b&&M?(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d):g&&b&&q&&A?(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d):j&&q&&R&&g&&(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d),z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}}else if(5==x)if((A||b||R)&&(j||b||R)&&(q||g||M)&&(k||g||M)&&(g||k||q)&&(M||k||q)&&(R||A||j)&&(b||A||j))if((k||A||q)&&(k||j||q)&&(j||A||q)&&(k||j||A)&&(b||g||R)&&(b||M||R)&&(M||g||R)&&(b||M||g)&&(k||A||g)&&(A||g||b)&&(k||g||b)&&(k||A||b)&&(q||A||R)&&(q||g||R)&&(A||g||R)&&(q||A||g)&&(q||j||M)&&(j||M||R)&&(q||M||R)&&(q||j||R)&&(k||j||b)&&(k||b||M)&&(b||j||M)&&(k||j||M))if((k||A||R)&&(j||q||b)&&(M||R||A)&&(b||g||q)&&(k||j||R)&&(g||R||j)&&(A||q||M)&&(b||M||q)&&(k||b||R)&&(q||R||k)&&(A||g||M)&&(j||M||g)){if(!((k||A||M)&&(j||q||g)&&(M||R||k)&&(b||g||j)&&(k||j||g)&&(g||R||k)&&(A||q||b)&&(b||M||A)&&(k||b||q)&&(q||R||b)&&(A||g||j)&&(j||M||A))){for(k||A||M?j||q||g?M||R||k?b||g||j?k||j||g?g||R||k?A||q||b?b||M||A?k||b||q?q||R||b?A||g||j?j||M||A||(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,m[4][0]=n,m[4][1]=y+1,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d,m[4][0]=n,m[4][1]=y,m[4][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y+1,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d,m[4][0]=n+1,m[4][1]=y+1,m[4][2]=d):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n,m[4][1]=y+1,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n,m[4][1]=y+1,m[4][2]=d):(m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[4][0]=n+1,m[4][1]=y+1,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y+1,m[4][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d,m[4][0]=n+1,m[4][1]=y,m[4][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n,m[4][1]=y,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y+1,m[4][2]=d+1),z=0;5>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);
l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[4][0]][m[4][1]][m[4][2]],r[m[1][0]][m[1][1]][m[1][2]])),v++}}else{for(k||A||R?j||q||b?M||R||A?b||g||q?k||j||R?g||R||j?A||q||M?b||M||q?k||b||R?q||R||k?A||g||M?j||M||g||(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y,m[4][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,m[4][0]=n,m[4][1]=y+1,m[4][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d,m[4][0]=n,m[4][1]=y,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y+1,m[4][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d,m[4][0]=n+1,m[4][1]=y,m[4][2]=d):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n,m[4][1]=y,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n,m[4][1]=y,m[4][2]=d):(m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[4][0]=n+1,m[4][1]=y,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n,m[4][1]=y+1,m[4][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d,m[4][0]=n,m[4][1]=y,m[4][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y,m[4][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1,m[4][0]=n,m[4][1]=y+1,m[4][2]=d+1),z=0;5>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++,l.push(new P(r[m[2][0]][m[2][1]][m[2][2]],r[m[4][0]][m[4][1]][m[4][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else{for(k||A||q?k||j||q?j||A||q?k||j||A?b||g||R?b||M||R?M||g||R?b||M||g?k||A||g?A||g||b?k||g||b?k||A||b?q||A||R?q||g||R?A||g||R?q||A||g?q||j||M?j||M||R?q||M||R?q||j||R?k||j||b?k||b||M?b||j||M?k||j||M||(m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):(m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d):(m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d):(m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):(m[2][0]=n,m[2][1]=y,m[2][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):(m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d):(m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[0][0]=n,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d):(m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):(m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):(m[2][0]=n,m[2][1]=y,m[2][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d):(m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d):(m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[0][0]=n,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):(m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):(m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d):(m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[3][0]=n,m[3][1]=y,m[3][2]=d):(m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):(m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1):(m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):(m[2][0]=n,m[2][1]=y,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):(m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[0][0]=n,m[0][1]=y,m[0][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):(m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d):(m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d):(m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d):(m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d),z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else{for(A||b||R?j||b||R?q||g||M?k||g||M?g||k||q?M||k||q?R||A||j?b||A||j||(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}else if(6==x){if(!k&&!A||!j&&!q||!M&&!R||!b&&!g||!k&&!j||!g&&!R||!A&&!q||!b&&!M||!k&&!b||!q&&!R||!A&&!g||!j&&!M){for(k||A?j||q?M||R?b||g?k||j?g||R?A||q?b||M?k||b?q||R?A||g?j||M||(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d),z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}else if(!k&&!R||!A&&!M||!j&&!g||!q&&!b){for(k||R?A||M?j||g?q||b||(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y,m[4][2]=d,m[5][0]=n,m[5][1]=y+1,m[5][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1,m[4][0]=n+1,m[4][1]=y+1,m[4][2]=d,m[5][0]=n,m[5][1]=y,m[5][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1,m[4][0]=n,m[4][1]=y,m[4][2]=d,m[5][0]=n+1,m[5][1]=y+1,m[5][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[3][0]=n,m[3][1]=y,m[3][2]=d+1,m[4][0]=n,m[4][1]=y+1,m[4][2]=d,m[5][0]=n+1,m[5][1]=y,m[5][2]=d),z=0;6>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[3][0]][m[3][1]][m[3][2]],r[m[4][0]][m[4][1]][m[4][2]],r[m[5][0]][m[5][1]][m[5][2]])),v++}else if(!k&&!g||!A&&!b||!A&&!R||!q&&!g||!q&&!M||!j&&!R||!j&&!b||!k&&!M||!b&&!R||!g&&!M||!k&&!q||!A&&!j){for(k||g?A||b?A||R?q||g?q||M?j||R?j||b?k||M?b||R?g||M?k||q?A||j||(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[3][0]=n+1,m[3][1]=y,m[3][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[3][0]=n+1,m[3][1]=y,m[3][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[3][0]=n,m[3][1]=y,m[3][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[3][0]=n,m[3][1]=y,m[3][2]=d+1):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[3][0]=n,m[3][1]=y+1,m[3][2]=d):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[3][0]=n,m[3][1]=y+1,m[3][2]=d+1):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d):(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[3][0]=n+1,m[3][1]=y+1,m[3][2]=d+1),z=0;4>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++,l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[2][0]][m[2][1]][m[2][2]],r[m[3][0]][m[3][1]][m[3][2]])),v++}}else if(7==x){for(k?A?q?j?b?g?R?M||(m[0][0]=n,m[0][1]=y,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y+1,m[2][2]=d):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n+1,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d+1,m[1][0]=n,m[1][1]=y,m[1][2]=d+1,m[2][0]=n+1,m[2][1]=y,m[2][2]=d):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d+1,m[1][0]=n,m[1][1]=y+1,m[1][2]=d+1,m[2][0]=n,m[2][1]=y,m[2][2]=d):(m[0][0]=n+1,m[0][1]=y+1,m[0][2]=d,m[1][0]=n,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y+1,m[2][2]=d+1):(m[0][0]=n+1,m[0][1]=y,m[0][2]=d,m[1][0]=n,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y+1,m[2][2]=d+1):(m[0][0]=n,m[0][1]=y,m[0][2]=d,m[1][0]=n+1,m[1][1]=y+1,m[1][2]=d,m[2][0]=n+1,m[2][1]=y,m[2][2]=d+1):(m[0][0]=n,m[0][1]=y+1,m[0][2]=d,m[1][0]=n+1,m[1][1]=y,m[1][2]=d,m[2][0]=n,m[2][1]=y,m[2][2]=d+1),z=0;3>z;++z)-1==r[m[z][0]][m[z][1]][m[z][2]]&&(r[m[z][0]][m[z][1]][m[z][2]]=f,w.push(new C(m[z][0],m[z][1],m[z][2])),f++);l.push(new P(r[m[0][0]][m[0][1]][m[0][2]],r[m[1][0]][m[1][1]][m[1][2]],r[m[2][0]][m[2][1]][m[2][2]])),v++}}for(this.faces=l,this.verts=w,n=0;f>n;++n)w[n].atomid=a[w[n].x*s*t+t*w[n].y+w[n].z].atomid},this.laplaciansmooth=function(i){for(var n=new Array(f),o=0;f>o;++o)n[o]={x:0,y:0,z:0};for(var r,t=new Array(20),o=0;20>o;++o)t[o]=new Array(f);for(var o=0;f>o;++o)t[0][o]=0;for(var o=0;v>o;++o){r=!0;for(var s=0;s<t[0][l[o].a];++s)if(l[o].b==t[s+1][l[o].a]){r=!1;break}r&&(t[0][l[o].a]++,t[t[0][l[o].a]][l[o].a]=l[o].b),r=!0;for(var s=0;s<t[0][l[o].a];++s)if(l[o].c==t[s+1][l[o].a]){r=!1;break}for(r&&(t[0][l[o].a]++,t[t[0][l[o].a]][l[o].a]=l[o].c),r=!0,s=0;s<t[0][l[o].b];++s)if(l[o].a==t[s+1][l[o].b]){r=!1;break}for(r&&(t[0][l[o].b]++,t[t[0][l[o].b]][l[o].b]=l[o].a),r=!0,s=0;s<t[0][l[o].b];++s)if(l[o].c==t[s+1][l[o].b]){r=!1;break}for(r&&(t[0][l[o].b]++,t[t[0][l[o].b]][l[o].b]=l[o].c),r=!0,s=0;s<t[0][l[o].c];++s)if(l[o].a==t[s+1][l[o].c]){r=!1;break}for(r&&(t[0][l[o].c]++,t[t[0][l[o].c]][l[o].c]=l[o].a),r=!0,s=0;s<t[0][l[o].c];++s)if(l[o].b==t[s+1][l[o].c]){r=!1;break}r&&(t[0][l[o].c]++,t[t[0][l[o].c]][l[o].c]=l[o].b)}for(var e=1,a=.5,u=0;i>u;++u){for(var o=0;f>o;++o)if(t[0][o]<3)n[o].x=w[o].x,n[o].y=w[o].y,n[o].z=w[o].z;else if(3==t[0][o]||4==t[0][o]){for(n[o].x=0,n[o].y=0,n[o].z=0,s=0;s<t[0][o];++s)n[o].x+=w[t[s+1][o]].x,n[o].y+=w[t[s+1][o]].y,n[o].z+=w[t[s+1][o]].z;n[o].x+=a*w[o].x,n[o].y+=a*w[o].y,n[o].z+=a*w[o].z,n[o].x/=a+t[0][o],n[o].y/=a+t[0][o],n[o].z/=a+t[0][o]}else{n[o].x=0,n[o].y=0,n[o].z=0;for(var s=0;s<t[0][o];++s)n[o].x+=w[t[s+1][o]].x,n[o].y+=w[t[s+1][o]].y,n[o].z+=w[t[s+1][o]].z;n[o].x+=e*w[o].x,n[o].y+=e*w[o].y,n[o].z+=e*w[o].z,n[o].x/=e+t[0][o],n[o].y/=e+t[0][o],n[o].z/=e+t[0][o]}for(var o=0;f>o;++o)w[o].x=n[o].x,w[o].y=n[o].y,w[o].z=n[o].z}},this.transformVertices=function(){for(var i=this.verts,t=1/m,s=0;f>s;++s)i[s].x=i[s].x*t-n,i[s].y=i[s].y*t-o,i[s].z=i[s].z*t-r},this.getModel=function(){return{verts:this.verts,faces:this.faces}}};onmessage=function(i){var n=i.data,o=n.min,r=n.max,t=n.atoms,s=n.type,e=new ProteinSurface;e.initparm(o,r,s>1),e.fillvoxels(t),e.buildboundary(),(4==s||2==s)&&e.fastdistancemap(),2==s&&(e.boundingatom(!1),e.fillvoxelswaals(t)),e.marchingcube(s),e.laplaciansmooth(1),e.transformVertices(),postMessage(e.getModel())};